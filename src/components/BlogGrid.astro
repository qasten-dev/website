---
import { formatDate, type Blog } from "@/utils/blog";
import { getSafeCurrentLocale } from "@/utils/i18n";
import { Image } from "astro:assets";
import { getRelativeLocaleUrl } from "astro:i18n";

const { posts, numCols = 3 } = Astro.props as {
  posts: Blog[];
  numCols?: 2 | 3;
};

const currentLocale = getSafeCurrentLocale(Astro.currentLocale);
const lgClass = numCols === 3 ? "lg:grid-cols-3" : "";
---

<div class=`grid gap-8 sm:grid-cols-2 ${lgClass}`>
  {
    posts.map(({ id, data }) => (
      <a
        href={getRelativeLocaleUrl(currentLocale, `/blog/${id}`)}
        class="hover:bg-card bg-card/50 border-border block overflow-hidden rounded-md border shadow-sm transition hover:shadow-md"
      >
        <Image
          src={data.image.src}
          alt={data.image.alt}
          class="bg-muted h-48 object-cover"
        />

        <div class="p-4">
          <h2 class="text-lg font-semibold">{data.title}</h2>
          <p class="text-muted-foreground mt-2 text-xs">
            {formatDate(data.publishedDate, currentLocale)}
          </p>
          <p class="text-muted-foreground mt-3 line-clamp-2 text-sm">
            {data.summary}
          </p>
        </div>
      </a>
    ))
  }
</div>
