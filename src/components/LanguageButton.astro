---
import { getSafeCurrentLocale } from "@/utils/i18n";
import { getRelativeLocaleUrl } from "astro:i18n";

const currentLocale = getSafeCurrentLocale(Astro.currentLocale);
const { locale } = Astro.props;
const { pathname } = Astro.url;

const selected = locale === currentLocale;

const localeFreePathname = pathname.startsWith(`/${currentLocale}/`)
  ? pathname.replace(`/${currentLocale}`, "")
  : pathname;
---

<button
  class={`px-4 py-2 text-sm rounded-xl font-medium transition ${
    selected
      ? "bg-white text-black"
      : "text-white inset-ring-2 inset-ring-white hover:bg-white hover:text-black cursor-pointer"
  }`}
  disabled={selected}
  onclick={selected
    ? undefined
    : `location='${getRelativeLocaleUrl(locale, localeFreePathname)}'`}
>
  {locale.toUpperCase()}
</button>
