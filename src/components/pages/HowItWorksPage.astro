---
import Layout from "@/layouts/Layout.astro";
import { Icon } from "astro-icon/components";
import { getSafeCurrentLocale } from "@/utils/i18n";
import { getRelativeLocaleUrl } from "astro:i18n";

const currentLocale = getSafeCurrentLocale(Astro.currentLocale);
const bookCallURL = getRelativeLocaleUrl(
  currentLocale,
  "/#book-call",
).replace(/\/$/, "");

const processSteps = [
  {
    step: "STEP 01",
    title: "We Configure Your System",
    description:
      "We connect to your existing phone line and calendar. No hardware. No disruption. Setup takes less than a week.",
    bullets: [
      "Forward your main line or add a dedicated number",
      "Connect to your scheduling system or we provide one",
      "Define your service area, hours, and job types",
    ],
    icon: "mdi:cog-outline",
    visual: "setup",
  },
  {
    step: "STEP 02",
    title: "AI Answers Every Call",
    description:
      "Calls are answered instantly, 24 hours a day. The AI gathers job details, qualifies the lead, and handles basic questions.",
    bullets: [
      "Immediate pickup, no hold music",
      "Collects name, address, job type, urgency",
      "Answers common questions about your services",
    ],
    icon: "mdi:headset",
    visual: "call",
  },
  {
    step: "STEP 03",
    title: "Jobs Are Booked Automatically",
    description:
      "Qualified leads are booked directly into your calendar. You get notified. The customer gets a confirmation.",
    bullets: [
      "Real-time calendar sync",
      "Confirmation sent to customer via text and email",
      "You see the job details before you arrive",
    ],
    icon: "mdi:calendar-month-outline",
    visual: "booking",
  },
  {
    step: "STEP 04",
    title: "No Lead Falls Through",
    description:
      "Leads that do not book immediately get automated follow up. Missed calls are recovered. Estimates are tracked.",
    bullets: [
      "Automated text and email sequences",
      "Reminder for pending estimates",
      "Re-engagement for missed calls",
    ],
    icon: "mdi:refresh-circle",
    visual: "followup",
  },
];
---

<Layout
  title="How It Works | Qasten"
  description="From setup to booked jobs in days. A simple 4-step process built for HVAC companies."
  noBackground={true}
>
  <main class="w-full">
    <section class="how-hero relative left-1/2 w-screen -translate-x-1/2 overflow-hidden bg-gradient-to-br from-neutral-950 via-neutral-900 to-neutral-950">
      <div class="hero-mesh how-hero-mesh"></div>
      <div class="how-hero-glow-left"></div>
      <div class="how-hero-glow-right"></div>

      <div class="container-custom relative z-10 py-20 text-center md:py-28 lg:py-32">
        <div class="mx-auto max-w-4xl">
          <span class="badge badge-dark mb-8">
            <Icon name="mdi:flash" class="text-sm text-[var(--brand-accent)]" />
            Simple 4-Step Process
          </span>
          <h1 class="mb-6 text-4xl font-bold tracking-tight text-white sm:text-5xl lg:text-6xl">
            From Setup to <span class="text-blue-300">Booked Jobs</span> in Days
          </h1>
          <p class="mx-auto mb-10 max-w-3xl text-lg leading-relaxed text-neutral-300 sm:text-2xl">
            A complete AI-powered intake system designed specifically for HVAC companies.
            No complicated setup. No long contracts.
          </p>

          <div class="mt-6 flex flex-wrap items-center justify-center gap-4">
            <span class="inline-flex items-center gap-1.5 text-sm font-medium text-neutral-400">
              <Icon name="mdi:check-circle-outline" class="text-base text-emerald-500" />
              No Long-Term Contracts
            </span>
            <span class="inline-flex items-center gap-1.5 text-sm font-medium text-neutral-400">
              <Icon name="mdi:check-circle-outline" class="text-base text-emerald-500" />
              Setup in Days
            </span>
            <span class="inline-flex items-center gap-1.5 text-sm font-medium text-neutral-400">
              <Icon name="mdi:check-circle-outline" class="text-base text-emerald-500" />
              HVAC-Specific
            </span>
          </div>

          <div class="how-hero-stats mt-12">
            <div class="text-center">
              <p class="text-3xl font-bold text-white sm:text-4xl lg:text-5xl">&lt; 48 h</p>
              <p class="mt-2 text-sm font-medium text-neutral-400 sm:text-base">Setup Time</p>
            </div>
            <div class="text-center">
              <p class="text-3xl font-bold text-white sm:text-4xl lg:text-5xl">0</p>
              <p class="mt-2 text-sm font-medium text-neutral-400 sm:text-base">Hardware Required</p>
            </div>
            <div class="text-center">
              <p class="text-3xl font-bold text-white sm:text-4xl lg:text-5xl">24/7</p>
              <p class="mt-2 text-sm font-medium text-neutral-400 sm:text-base">Call Coverage</p>
            </div>
            <div class="text-center">
              <p class="text-3xl font-bold text-white sm:text-4xl lg:text-5xl">100%</p>
              <p class="mt-2 text-sm font-medium text-neutral-400 sm:text-base">Calls Answered</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section-spacing how-process-section bg-neutral-50">
      <div class="container-custom">
        <div class="process-intro text-center">
          <span class="badge bg-primary/10 text-primary">The Process</span>
          <h2 class="mt-6 mb-4 text-4xl font-bold tracking-tight text-neutral-900 sm:text-5xl lg:text-6xl">
            Four Steps to Never Missing a Call Again
          </h2>
          <p class="mx-auto max-w-3xl text-lg leading-relaxed text-neutral-600 sm:text-xl">
            We handle everything from setup to ongoing optimization.
          </p>
        </div>

        <div class="process-list">
          {processSteps.map((item, idx) => (
            <article class={`process-row ${idx % 2 === 1 ? "reverse" : ""}`}>
              <div class="process-copy">
                <div class="process-head">
                  <span class="process-icon">
                    <Icon name={item.icon} class="text-3xl text-white" />
                  </span>
                  <div>
                    <p class="process-step-label">{item.step}</p>
                    <h3 class="process-title">{item.title}</h3>
                  </div>
                </div>
                <p class="process-description">{item.description}</p>
                <ul class="process-bullets">
                  {item.bullets.map((bullet) => (
                    <li>{bullet}</li>
                  ))}
                </ul>
              </div>

              <div class="airvvy-card process-visual">
                {item.visual === "setup" && (
                  <>
                    <div class="mock-row">
                      <Icon name="mdi:phone-outline" class="text-primary text-lg" />
                      <div class="mock-bars">
                        <span class="mock-bar w-[74%]"></span>
                        <span class="mock-bar-lite w-[52%]"></span>
                      </div>
                      <Icon name="mdi:check-circle-outline" class="text-emerald-500 text-lg" />
                    </div>
                    <div class="mock-row">
                      <Icon name="mdi:calendar-month-outline" class="text-primary text-lg" />
                      <div class="mock-bars">
                        <span class="mock-bar w-[64%]"></span>
                        <span class="mock-bar-lite w-[38%]"></span>
                      </div>
                      <Icon name="mdi:check-circle-outline" class="text-emerald-500 text-lg" />
                    </div>
                    <div class="mock-row">
                      <Icon name="mdi:cog-outline" class="text-primary text-lg" />
                      <div class="mock-bars">
                        <span class="mock-bar w-[80%]"></span>
                        <span class="mock-bar-lite w-[47%]"></span>
                      </div>
                      <Icon name="mdi:check-circle-outline" class="text-emerald-500 text-lg" />
                    </div>
                  </>
                )}

                {item.visual === "call" && (
                  <div class="call-mock">
                    <div class="flex items-center gap-3">
                      <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-emerald-500/15 text-emerald-400">
                        <Icon name="mdi:phone" class="text-xl" />
                      </span>
                      <div>
                        <p class="text-base font-semibold text-white">Incoming Call</p>
                        <p class="text-sm text-emerald-400">Answering...</p>
                      </div>
                    </div>
                    <div class="call-bubble">"Thank you for calling! How can I help?"</div>
                    <div class="call-bubble call-bubble-primary">“My AC is not cooling...”</div>
                    <div class="call-bubble">“I can schedule a technician today...”</div>
                  </div>
                )}

                {item.visual === "booking" && (
                  <>
                    <div class="booking-card">
                      <div class="flex items-start justify-between gap-3">
                        <p class="text-xl font-semibold text-neutral-900">New Booking</p>
                        <span class="rounded-full bg-emerald-100 px-3 py-1 text-sm font-medium text-emerald-700">
                          Confirmed
                        </span>
                      </div>
                      <p class="mt-4 text-base text-neutral-600">AC Repair - Emergency</p>
                      <p class="mt-1 text-base text-neutral-600">Today, 2:00 PM - 4:00 PM</p>
                      <p class="mt-1 text-base text-neutral-600">123 Main St, Chicago, IL</p>
                    </div>
                    <div class="grid gap-3 sm:grid-cols-2">
                      <div class="flex items-center gap-3 rounded-2xl border border-neutral-200 bg-white px-4 py-4">
                        <Icon name="mdi:message-outline" class="text-primary text-2xl shrink-0" />
                        <p class="text-base text-neutral-600">SMS Sent</p>
                      </div>
                      <div class="flex items-center gap-3 rounded-2xl border border-neutral-200 bg-white px-4 py-4">
                        <Icon name="mdi:bell-outline" class="text-primary text-2xl shrink-0" />
                        <p class="text-base text-neutral-600">You Notified</p>
                      </div>
                    </div>
                  </>
                )}

                {item.visual === "followup" && (
                  <>
                    <div class="followup-item">
                      <span class="followup-check"><Icon name="mdi:check" class="text-lg" /></span>
                      <div>
                        <p class="text-base font-medium text-neutral-900">Confirmation sent</p>
                        <p class="text-sm text-neutral-500">Day 1</p>
                      </div>
                    </div>
                    <div class="followup-item">
                      <span class="followup-check"><Icon name="mdi:check" class="text-lg" /></span>
                      <div>
                        <p class="text-base font-medium text-neutral-900">Reminder sent</p>
                        <p class="text-sm text-neutral-500">Day 2</p>
                      </div>
                    </div>
                    <div class="followup-item">
                      <span class="followup-check"><Icon name="mdi:check" class="text-lg" /></span>
                      <div>
                        <p class="text-base font-medium text-neutral-900">Follow-up call</p>
                        <p class="text-sm text-neutral-500">Day 3</p>
                      </div>
                    </div>
                    <div class="followup-item">
                      <span class="followup-pending">
                        <Icon name="mdi:clock-outline" class="text-lg" />
                      </span>
                      <div>
                        <p class="text-base font-medium text-neutral-900">Review request</p>
                        <p class="text-sm text-neutral-500">Day 7</p>
                      </div>
                    </div>
                  </>
                )}
              </div>
            </article>
          ))}
        </div>

        <div class="process-cta-wrap">
          <a href={bookCallURL} class="cta-button min-h-14 px-9 py-4 text-base font-bold">
            Start your Free 7-Day Pilot
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  .how-hero {
    isolation: isolate;
  }

  .how-hero-mesh {
    opacity: 0.48;
    mix-blend-mode: screen;
  }

  .how-hero-glow-left {
    position: absolute;
    top: 5rem;
    left: 2rem;
    width: 18rem;
    height: 18rem;
    border-radius: 999px;
    background: rgb(74 125 189 / 0.20);
    filter: blur(110px);
    pointer-events: none;
  }

  .how-hero-glow-right {
    position: absolute;
    right: 2rem;
    bottom: 2.5rem;
    width: 20rem;
    height: 20rem;
    border-radius: 999px;
    background: rgb(107 159 255 / 0.10);
    filter: blur(120px);
    pointer-events: none;
  }

  .how-hero-stats {
    display: grid;
    gap: 1.6rem;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    max-width: 72rem;
    margin-inline: auto;
  }

  @media (min-width: 1024px) {
    .how-hero-stats {
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 2.25rem;
    }
  }

  .how-process-section {
    padding-top: clamp(4rem, 7.2vw, 6.4rem);
    padding-bottom: clamp(4.5rem, 8vw, 7rem);
  }

  .process-intro {
    margin-bottom: clamp(2.7rem, 5.8vw, 4.6rem);
  }

  .process-list {
    display: grid;
    gap: clamp(3.25rem, 6vw, 5.2rem);
  }

  .process-cta-wrap {
    margin-top: clamp(1.1rem, 2.3vw, 2rem);
    display: flex;
    justify-content: center;
  }

  .process-row {
    display: grid;
    gap: clamp(1.45rem, 3.4vw, 2.4rem);
    align-items: center;
  }

  .process-copy {
    min-width: 0;
    padding-right: clamp(0rem, 1.3vw, 0.8rem);
  }

  .process-head {
    display: flex;
    align-items: center;
    gap: 1.1rem;
    margin-bottom: 1.25rem;
  }

  .process-icon {
    display: inline-flex;
    width: 4.25rem;
    height: 4.25rem;
    align-items: center;
    justify-content: center;
    border-radius: 1.3rem;
    background: linear-gradient(180deg, #1f7aff 0%, #0056d6 100%);
    box-shadow: 0 8px 20px rgb(0 86 214 / 0.28);
    flex-shrink: 0;
  }

  .process-step-label {
    color: #0f6be5;
    font-size: 0.95rem;
    font-weight: 700;
    letter-spacing: 0.05em;
    margin: 0;
  }

  .process-title {
    margin: 0.1rem 0 0;
    font-size: clamp(1.85rem, 3.1vw, 2.45rem);
    line-height: 1.16;
    letter-spacing: -0.02em;
    font-weight: 700;
    color: #0f172a;
  }

  .process-description {
    margin: 0 0 1.35rem;
    color: #475569;
    font-size: 1.12rem;
    line-height: 1.55;
    max-width: 58ch;
  }

  .process-bullets {
    list-style: none;
    margin: 0;
    padding: 0;
    display: grid;
    gap: 0.86rem;
    color: #334155;
    font-size: 1.03rem;
  }

  .process-bullets li {
    display: flex;
    align-items: flex-start;
    gap: 0.7rem;
    line-height: 1.4;
  }

  .process-bullets li::before {
    content: "✓";
    margin-top: 0.1rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 1.3rem;
    height: 1.3rem;
    border-radius: 999px;
    background: rgb(34 197 94 / 0.18);
    color: #16a34a;
    font-size: 0.9rem;
    font-weight: 700;
    flex-shrink: 0;
  }

  .process-visual {
    padding: clamp(1.35rem, 2.2vw, 2rem);
    display: grid;
    gap: 0.95rem;
    min-width: 0;
  }

  .mock-row {
    border-radius: 0.9rem;
    background: #ffffff;
    border: 1px solid rgb(226 232 240 / 0.92);
    padding: 0.72rem 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    box-shadow: 0 2px 8px rgb(15 23 42 / 0.06);
  }

  .mock-bars {
    min-width: 0;
    flex: 1;
    display: grid;
    gap: 0.44rem;
  }

  .mock-bar,
  .mock-bar-lite {
    display: block;
    height: 0.38rem;
    border-radius: 999px;
  }

  .mock-bar {
    background: #d1d5db;
  }

  .mock-bar-lite {
    background: #a7e6ba;
  }

  .call-mock {
    border-radius: 1.1rem;
    background:
      radial-gradient(120% 120% at 110% -10%, rgb(26 115 232 / 0.16), transparent 44%),
      #0a1a3d;
    border: 1px solid rgb(15 23 42 / 0.35);
    padding: 1rem;
    display: grid;
    gap: 0.72rem;
  }

  .call-bubble {
    border-radius: 0.9rem;
    background: rgb(30 41 59 / 0.9);
    color: rgb(226 232 240);
    font-size: 0.96rem;
    padding: 0.65rem 0.82rem;
  }

  .call-bubble-primary {
    background: linear-gradient(90deg, #1a73e8, #0f6be5);
    color: #eaf4ff;
  }

  .booking-card {
    border-radius: 1rem;
    border: 1px solid rgb(226 232 240 / 0.92);
    background: #ffffff;
    padding: 0.95rem;
  }

  .followup-item {
    border-radius: 0.95rem;
    border: 1px solid rgb(226 232 240 / 0.92);
    background: #ffffff;
    padding: 0.75rem 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.7rem;
  }

  .followup-check,
  .followup-pending {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 1.8rem;
    height: 1.8rem;
    border-radius: 999px;
    flex-shrink: 0;
  }

  .followup-check {
    background: rgb(34 197 94 / 0.18);
    color: #16a34a;
  }

  .followup-pending {
    background: rgb(148 163 184 / 0.16);
    color: #64748b;
  }

  @media (min-width: 1024px) {
    .process-row {
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: clamp(2.6rem, 5vw, 4.6rem);
    }

    .process-row.reverse .process-copy {
      order: 2;
      padding-right: 0;
      padding-left: clamp(0rem, 1.3vw, 0.8rem);
    }

    .process-row.reverse .process-visual {
      order: 1;
    }
  }

  @media (max-width: 1023px) {
    .process-row {
      gap: 1.5rem;
    }

    .process-copy {
      padding-right: 0;
    }

    .process-intro {
      margin-bottom: 2.5rem;
    }

    .process-cta-wrap {
      margin-top: clamp(1.8rem, 6vw, 2.8rem);
    }
  }
</style>
