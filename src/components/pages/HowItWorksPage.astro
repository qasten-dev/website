---
import Layout from "@/layouts/Layout.astro";
import { Icon } from "astro-icon/components";
import { getSafeCurrentLocale } from "@/utils/i18n";
import { getRelativeLocaleUrl } from "astro:i18n";

const currentLocale = getSafeCurrentLocale(Astro.currentLocale);
const bookCallURL = getRelativeLocaleUrl(
  currentLocale,
  "/#book-call",
).replace(/\/$/, "");

const processSteps = [
  {
    step: "STEP 01",
    title: "We Configure Your System",
    description:
      "We connect to your existing phone line and calendar. No hardware. No disruption. Setup takes less than a week.",
    bullets: [
      "Forward your main line or add a dedicated number",
      "Connect to your scheduling system or we provide one",
      "Define your service area, hours, and job types",
    ],
    icon: "mdi:cog-outline",
    visual: "setup",
  },
  {
    step: "STEP 02",
    title: "AI Answers Every Call",
    description:
      "Calls are answered instantly, 24 hours a day. The AI gathers job details, qualifies the lead, and handles basic questions.",
    bullets: [
      "Immediate pickup, no hold music",
      "Collects name, address, job type, urgency",
      "Answers common questions about your services",
    ],
    icon: "mdi:headset",
    visual: "call",
  },
  {
    step: "STEP 03",
    title: "Jobs Are Booked Automatically",
    description:
      "Qualified leads are booked directly into your calendar. You get notified. The customer gets a confirmation.",
    bullets: [
      "Real-time calendar sync",
      "Confirmation sent to customer via text and email",
      "You see the job details before you arrive",
    ],
    icon: "mdi:calendar-month-outline",
    visual: "booking",
  },
  {
    step: "STEP 04",
    title: "No Lead Falls Through",
    description:
      "Leads that do not book immediately get automated follow up. Missed calls are recovered. Estimates are tracked.",
    bullets: [
      "Automated text and email sequences",
      "Reminder for pending estimates",
      "Re-engagement for missed calls",
    ],
    icon: "mdi:refresh-circle",
    visual: "followup",
  },
];
---

<Layout
  title="How It Works | Qasten"
  description="From setup to booked jobs in days. A simple 4-step process built for HVAC companies."
  noBackground={true}
>
  <main class="w-full">
    <section class="how-hero relative left-1/2 w-screen -translate-x-1/2 overflow-hidden">
      <div class="hero-mesh how-hero-mesh"></div>
      <div class="how-hero-column-glow"></div>
      <div class="how-hero-corner how-hero-corner-left"></div>
      <div class="how-hero-corner how-hero-corner-right"></div>

      <div class="container-custom how-hero-shell relative z-10 text-center">
        <div class="how-hero-content">
          <span class="how-hero-badge">
            <Icon name="mdi:flash" class="text-sm text-[var(--brand-secondary-light)]" />
            Simple 4-Step Process
          </span>
          <h1 class="how-hero-title mx-auto max-w-4xl text-white">
            From Setup to <span class="how-hero-highlight">Booked Jobs</span> in <br class="hidden sm:block" />Days
          </h1>
          <p class="how-hero-subhead mx-auto max-w-3xl">
            A complete AI-powered intake system designed specifically for HVAC companies.
            No complicated setup. No long contracts.
          </p>

          <div class="how-hero-trust">
            <span class="how-hero-trust-item">
              <Icon name="mdi:check-circle-outline" class="how-hero-trust-icon" />
              No Long-Term Contracts
            </span>
            <span class="how-hero-trust-item">
              <Icon name="mdi:check-circle-outline" class="how-hero-trust-icon" />
              Setup in Days
            </span>
            <span class="how-hero-trust-item">
              <Icon name="mdi:check-circle-outline" class="how-hero-trust-icon" />
              HVAC-Specific
            </span>
          </div>

          <div class="how-hero-stats">
            <div class="how-hero-stat">
              <p class="how-hero-stat-value">&lt; 48 h</p>
              <p class="how-hero-stat-label">Setup Time</p>
            </div>
            <div class="how-hero-stat">
              <p class="how-hero-stat-value">0</p>
              <p class="how-hero-stat-label">Hardware Required</p>
            </div>
            <div class="how-hero-stat">
              <p class="how-hero-stat-value">24/7</p>
              <p class="how-hero-stat-label">Call Coverage</p>
            </div>
            <div class="how-hero-stat">
              <p class="how-hero-stat-value">100%</p>
              <p class="how-hero-stat-label">Calls Answered</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section-spacing how-process-section bg-neutral-50">
      <div class="container-custom">
        <div class="process-intro text-center">
          <span class="badge bg-primary/10 text-primary">The Process</span>
          <h2 class="mt-6 mb-4 text-4xl font-bold tracking-tight text-neutral-900 sm:text-5xl lg:text-6xl">
            Four Steps to Never Missing a Call Again
          </h2>
          <p class="mx-auto max-w-3xl text-lg leading-relaxed text-neutral-600 sm:text-xl">
            We handle everything from setup to ongoing optimization.
          </p>
        </div>

        <div class="process-list">
          {processSteps.map((item, idx) => (
            <article class={`process-row ${idx % 2 === 1 ? "reverse" : ""}`}>
              <div class="process-copy">
                <div class="process-head">
                  <span class="process-icon">
                    <Icon name={item.icon} class="text-3xl text-white" />
                  </span>
                  <div>
                    <p class="process-step-label">{item.step}</p>
                    <h3 class="process-title">{item.title}</h3>
                  </div>
                </div>
                <p class="process-description">{item.description}</p>
                <ul class="process-bullets">
                  {item.bullets.map((bullet) => (
                    <li>{bullet}</li>
                  ))}
                </ul>
              </div>

              <div class="airvvy-card process-visual">
                {item.visual === "setup" && (
                  <>
                    <div class="mock-row">
                      <Icon name="mdi:phone-outline" class="text-primary text-lg" />
                      <div class="mock-bars">
                        <span class="mock-bar w-[74%]"></span>
                        <span class="mock-bar-lite w-[52%]"></span>
                      </div>
                      <Icon name="mdi:check-circle-outline" class="text-emerald-500 text-lg" />
                    </div>
                    <div class="mock-row">
                      <Icon name="mdi:calendar-month-outline" class="text-primary text-lg" />
                      <div class="mock-bars">
                        <span class="mock-bar w-[64%]"></span>
                        <span class="mock-bar-lite w-[38%]"></span>
                      </div>
                      <Icon name="mdi:check-circle-outline" class="text-emerald-500 text-lg" />
                    </div>
                    <div class="mock-row">
                      <Icon name="mdi:cog-outline" class="text-primary text-lg" />
                      <div class="mock-bars">
                        <span class="mock-bar w-[80%]"></span>
                        <span class="mock-bar-lite w-[47%]"></span>
                      </div>
                      <Icon name="mdi:check-circle-outline" class="text-emerald-500 text-lg" />
                    </div>
                  </>
                )}

                {item.visual === "call" && (
                  <div class="call-mock">
                    <div class="flex items-center gap-3">
                      <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-emerald-500/15 text-emerald-400">
                        <Icon name="mdi:phone" class="text-xl" />
                      </span>
                      <div>
                        <p class="text-base font-semibold text-white">Incoming Call</p>
                        <p class="text-sm text-emerald-400">Answering...</p>
                      </div>
                    </div>
                    <div class="call-bubble">"Thank you for calling! How can I help?"</div>
                    <div class="call-bubble call-bubble-primary">“My AC is not cooling...”</div>
                    <div class="call-bubble">“I can schedule a technician today...”</div>
                  </div>
                )}

                {item.visual === "booking" && (
                  <>
                    <div class="booking-card">
                      <div class="flex items-start justify-between gap-3">
                        <p class="text-xl font-semibold text-neutral-900">New Booking</p>
                        <span class="rounded-full bg-emerald-100 px-3 py-1 text-sm font-medium text-emerald-700">
                          Confirmed
                        </span>
                      </div>
                      <p class="mt-4 text-base text-neutral-600">AC Repair - Emergency</p>
                      <p class="mt-1 text-base text-neutral-600">Today, 2:00 PM - 4:00 PM</p>
                      <p class="mt-1 text-base text-neutral-600">123 Main St, Chicago, IL</p>
                    </div>
                    <div class="grid gap-3 sm:grid-cols-2">
                      <div class="rounded-2xl bg-blue-50 px-4 py-4 text-center">
                        <Icon name="mdi:message-outline" class="text-primary mb-1 text-2xl" />
                        <p class="text-base text-neutral-600">SMS Sent</p>
                      </div>
                      <div class="rounded-2xl bg-blue-50 px-4 py-4 text-center">
                        <Icon name="mdi:bell-outline" class="text-primary mb-1 text-2xl" />
                        <p class="text-base text-neutral-600">You Notified</p>
                      </div>
                    </div>
                  </>
                )}

                {item.visual === "followup" && (
                  <>
                    <div class="followup-item">
                      <span class="followup-check"><Icon name="mdi:check" class="text-lg" /></span>
                      <div>
                        <p class="text-base font-medium text-neutral-900">Confirmation sent</p>
                        <p class="text-sm text-neutral-500">Day 1</p>
                      </div>
                    </div>
                    <div class="followup-item">
                      <span class="followup-check"><Icon name="mdi:check" class="text-lg" /></span>
                      <div>
                        <p class="text-base font-medium text-neutral-900">Reminder sent</p>
                        <p class="text-sm text-neutral-500">Day 2</p>
                      </div>
                    </div>
                    <div class="followup-item">
                      <span class="followup-check"><Icon name="mdi:check" class="text-lg" /></span>
                      <div>
                        <p class="text-base font-medium text-neutral-900">Follow-up call</p>
                        <p class="text-sm text-neutral-500">Day 3</p>
                      </div>
                    </div>
                    <div class="followup-item">
                      <span class="followup-pending">
                        <Icon name="mdi:clock-outline" class="text-lg" />
                      </span>
                      <div>
                        <p class="text-base font-medium text-neutral-900">Review request</p>
                        <p class="text-sm text-neutral-500">Day 7</p>
                      </div>
                    </div>
                  </>
                )}
              </div>
            </article>
          ))}
        </div>

        <div class="process-cta-wrap">
          <a href={bookCallURL} class="cta-button min-h-14 px-9 py-4 text-base font-bold">
            Start your Free 7-Day Pilot
          </a>
        </div>
      </div>
    </section>
  </main>
</Layout>

<style>
  .how-hero {
    background: linear-gradient(
      145deg,
      color-mix(in srgb, var(--brand-secondary-dark), #000 55%) 0%,
      color-mix(in srgb, var(--brand-secondary-dark), #001524 65%) 48%,
      color-mix(in srgb, var(--brand-secondary), #001321 78%) 100%
    );
    isolation: isolate;
  }

  .how-hero-mesh {
    opacity: 0.48;
    mix-blend-mode: screen;
  }

  .how-hero-shell {
    padding-block: clamp(4.75rem, 10vw, 8.5rem);
  }

  .how-hero-content {
    display: grid;
    justify-items: center;
    row-gap: clamp(0.85rem, 1.6vw, 1.35rem);
  }

  .how-hero-column-glow {
    position: absolute;
    top: -5%;
    left: 50%;
    width: min(70vw, 44rem);
    height: 118%;
    transform: translateX(-50%);
    background: linear-gradient(
      180deg,
      color-mix(in srgb, var(--brand-secondary), white 18%) 0%,
      color-mix(in srgb, var(--brand-secondary), transparent 70%) 48%,
      transparent 100%
    );
    opacity: 0.18;
    filter: blur(64px);
    pointer-events: none;
  }

  .how-hero-corner {
    position: absolute;
    border-radius: 999px;
    pointer-events: none;
  }

  .how-hero-corner-left {
    top: 3.5rem;
    left: -6rem;
    width: 19rem;
    height: 19rem;
    background: color-mix(in srgb, var(--brand-secondary), transparent 58%);
    filter: blur(108px);
    opacity: 0.44;
  }

  .how-hero-corner-right {
    right: -7rem;
    bottom: -3rem;
    width: 24rem;
    height: 24rem;
    background: color-mix(in srgb, var(--brand-accent), transparent 68%);
    filter: blur(122px);
    opacity: 0.34;
  }

  .how-hero-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.45rem;
    border-radius: 999px;
    border: 1px solid rgb(148 163 184 / 0.28);
    background: rgb(30 41 59 / 0.46);
    color: rgb(226 232 240 / 0.95);
    font-size: 1.1rem;
    font-weight: 500;
    letter-spacing: 0.01em;
    padding: 0.62rem 1.18rem;
    backdrop-filter: blur(6px);
  }

  .how-hero-title {
    margin: 0;
    font-size: clamp(2.55rem, 7vw, 5rem);
    font-weight: 700;
    line-height: 1.04;
    letter-spacing: -0.03em;
    text-wrap: balance;
  }

  .how-hero-highlight {
    color: color-mix(in srgb, var(--brand-secondary-light), white 10%);
  }

  .how-hero-subhead {
    margin: 0;
    color: rgb(203 213 225 / 0.9);
    font-size: clamp(1.2rem, 2.5vw, 2.1rem);
    line-height: 1.44;
  }

  .how-hero-trust {
    margin-top: clamp(0.45rem, 1vw, 0.9rem);
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: 1.35rem 1.7rem;
  }

  .how-hero-trust-item {
    display: inline-flex;
    align-items: center;
    gap: 0.48rem;
    color: rgb(148 163 184 / 0.95);
    font-size: 1rem;
    font-weight: 500;
  }

  .how-hero-trust-icon {
    color: #22c55e;
    font-size: 1.05rem;
  }

  .how-hero-stats {
    margin-top: clamp(1rem, 2.4vw, 2.3rem);
    display: grid;
    gap: 1.6rem;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    max-width: 72rem;
    margin-inline: auto;
  }

  .how-hero-stat {
    text-align: center;
  }

  .how-hero-stat-value {
    color: rgb(248 250 252);
    font-size: clamp(2.2rem, 4.2vw, 3.35rem);
    font-weight: 700;
    line-height: 1.06;
    letter-spacing: -0.02em;
  }

  .how-hero-stat-label {
    margin-top: 0.5rem;
    color: rgb(148 163 184 / 0.92);
    font-size: 1.15rem;
    line-height: 1.3;
  }

  @media (min-width: 1024px) {
    .how-hero-content {
      row-gap: 1.2rem;
    }

    .how-hero-stats {
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 2.25rem;
    }
  }

  @media (max-width: 767px) {
    .how-hero-shell {
      padding-block: 4.25rem 4.75rem;
    }

    .how-hero-content {
      row-gap: 0.8rem;
    }

    .how-hero-badge {
      font-size: 0.95rem;
      padding: 0.5rem 0.95rem;
    }

    .how-hero-subhead {
      font-size: 1.08rem;
      line-height: 1.58;
    }

    .how-hero-trust-item {
      font-size: 0.92rem;
    }

    .how-hero-stats {
      margin-top: 0.95rem;
      gap: 1.2rem 0.9rem;
    }

    .how-hero-stat-value {
      font-size: clamp(1.85rem, 10vw, 2.35rem);
    }

    .how-hero-stat-label {
      font-size: 0.95rem;
    }
  }

  .how-process-section {
    padding-top: clamp(4rem, 7.2vw, 6.4rem);
    padding-bottom: clamp(4.5rem, 8vw, 7rem);
  }

  .process-intro {
    margin-bottom: clamp(2.7rem, 5.8vw, 4.6rem);
  }

  .process-list {
    display: grid;
    gap: clamp(3.25rem, 6vw, 5.2rem);
  }

  .process-cta-wrap {
    margin-top: clamp(1.1rem, 2.3vw, 2rem);
    display: flex;
    justify-content: center;
  }

  .process-row {
    display: grid;
    gap: clamp(1.45rem, 3.4vw, 2.4rem);
    align-items: center;
  }

  .process-copy {
    min-width: 0;
    padding-right: clamp(0rem, 1.3vw, 0.8rem);
  }

  .process-head {
    display: flex;
    align-items: center;
    gap: 1.1rem;
    margin-bottom: 1.25rem;
  }

  .process-icon {
    display: inline-flex;
    width: 4.25rem;
    height: 4.25rem;
    align-items: center;
    justify-content: center;
    border-radius: 1.3rem;
    background: linear-gradient(180deg, #1f7aff 0%, #0056d6 100%);
    box-shadow: 0 8px 20px rgb(0 86 214 / 0.28);
    flex-shrink: 0;
  }

  .process-step-label {
    color: #0f6be5;
    font-size: 0.95rem;
    font-weight: 700;
    letter-spacing: 0.05em;
    margin: 0;
  }

  .process-title {
    margin: 0.1rem 0 0;
    font-size: clamp(1.85rem, 3.1vw, 2.45rem);
    line-height: 1.16;
    letter-spacing: -0.02em;
    font-weight: 700;
    color: #0f172a;
  }

  .process-description {
    margin: 0 0 1.35rem;
    color: #475569;
    font-size: 1.12rem;
    line-height: 1.55;
    max-width: 58ch;
  }

  .process-bullets {
    list-style: none;
    margin: 0;
    padding: 0;
    display: grid;
    gap: 0.86rem;
    color: #334155;
    font-size: 1.03rem;
  }

  .process-bullets li {
    display: flex;
    align-items: flex-start;
    gap: 0.7rem;
    line-height: 1.4;
  }

  .process-bullets li::before {
    content: "✓";
    margin-top: 0.1rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 1.3rem;
    height: 1.3rem;
    border-radius: 999px;
    background: rgb(34 197 94 / 0.18);
    color: #16a34a;
    font-size: 0.9rem;
    font-weight: 700;
    flex-shrink: 0;
  }

  .process-visual {
    padding: clamp(1.35rem, 2.2vw, 2rem);
    display: grid;
    gap: 0.95rem;
    min-width: 0;
  }

  .mock-row {
    border-radius: 0.9rem;
    background: #ffffff;
    border: 1px solid rgb(226 232 240 / 0.92);
    padding: 0.72rem 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    box-shadow: 0 2px 8px rgb(15 23 42 / 0.06);
  }

  .mock-bars {
    min-width: 0;
    flex: 1;
    display: grid;
    gap: 0.44rem;
  }

  .mock-bar,
  .mock-bar-lite {
    display: block;
    height: 0.38rem;
    border-radius: 999px;
  }

  .mock-bar {
    background: #d1d5db;
  }

  .mock-bar-lite {
    background: #a7e6ba;
  }

  .call-mock {
    border-radius: 1.1rem;
    background:
      radial-gradient(120% 120% at 110% -10%, rgb(26 115 232 / 0.16), transparent 44%),
      #0a1a3d;
    border: 1px solid rgb(15 23 42 / 0.35);
    padding: 1rem;
    display: grid;
    gap: 0.72rem;
  }

  .call-bubble {
    border-radius: 0.9rem;
    background: rgb(30 41 59 / 0.9);
    color: rgb(226 232 240);
    font-size: 0.96rem;
    padding: 0.65rem 0.82rem;
  }

  .call-bubble-primary {
    background: linear-gradient(90deg, #1a73e8, #0f6be5);
    color: #eaf4ff;
  }

  .booking-card {
    border-radius: 1rem;
    border: 1px solid rgb(226 232 240 / 0.92);
    background: #ffffff;
    padding: 0.95rem;
  }

  .followup-item {
    border-radius: 0.95rem;
    border: 1px solid rgb(226 232 240 / 0.92);
    background: #ffffff;
    padding: 0.75rem 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.7rem;
  }

  .followup-check,
  .followup-pending {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 1.8rem;
    height: 1.8rem;
    border-radius: 999px;
    flex-shrink: 0;
  }

  .followup-check {
    background: rgb(34 197 94 / 0.18);
    color: #16a34a;
  }

  .followup-pending {
    background: rgb(148 163 184 / 0.16);
    color: #64748b;
  }

  @media (min-width: 1024px) {
    .process-row {
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: clamp(2.6rem, 5vw, 4.6rem);
    }

    .process-row.reverse .process-copy {
      order: 2;
      padding-right: 0;
      padding-left: clamp(0rem, 1.3vw, 0.8rem);
    }

    .process-row.reverse .process-visual {
      order: 1;
    }
  }

  @media (max-width: 1023px) {
    .process-row {
      gap: 1.5rem;
    }

    .process-copy {
      padding-right: 0;
    }

    .process-intro {
      margin-bottom: 2.5rem;
    }

    .process-cta-wrap {
      margin-top: clamp(1.8rem, 6vw, 2.8rem);
    }
  }
</style>
