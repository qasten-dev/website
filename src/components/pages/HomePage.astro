---
import Layout from "@/layouts/Layout.astro";
import FAQ from "@/components/FAQ.astro";
import { Icon } from "astro-icon/components";
import { getSafeCurrentLocale, getTranslations } from "@/utils/i18n";
import { getRelativeLocaleUrl } from "astro:i18n";

const currentLocale = getSafeCurrentLocale(Astro.currentLocale);
const t = getTranslations(currentLocale);
const p = t.homePage;
const howItWorksUrl = getRelativeLocaleUrl(
  currentLocale,
  "/how-it-works",
).replace(/\/$/, "");

const faqData = p.faq.items;
---

<Layout
  title={p.meta.title}
  description={p.meta.description}
  noBackground={true}
>
  <main class="w-full">
    <!-- Hero Section -->
    <section
      id="hero"
      class="relative left-1/2 w-screen -translate-x-1/2 overflow-hidden bg-gradient-to-br from-neutral-950 via-neutral-900 to-neutral-950"
    >
      <div class="hero-mesh"></div>
      <div class="absolute top-20 left-8 h-72 w-72 rounded-full bg-primary/20 blur-[110px]"></div>
      <div class="absolute right-8 bottom-10 h-80 w-80 rounded-full bg-[var(--brand-accent)]/10 blur-[120px]"></div>

      <div class="container-custom relative z-10 py-20 text-center md:py-28 lg:py-32">
        <div class="animate-on-scroll mx-auto max-w-4xl">
          <span class="badge badge-dark mb-8">Built for HVAC Companies</span>
          <h1 class="mb-6 text-4xl font-bold tracking-tight text-white sm:text-5xl lg:text-6xl">
            {p.hero.titlePrefix}{" "}
            <span class="bg-gradient-to-r from-[var(--brand-secondary)] to-[var(--brand-secondary-light)] bg-clip-text text-transparent">
              {p.hero.titleHighlight}
            </span>{" "}
            {p.hero.titleSuffix}
          </h1>
          <p class="mx-auto mb-10 max-w-3xl text-lg leading-relaxed text-neutral-300 sm:text-2xl">
            {p.hero.subhead}
          </p>
          <div class="flex flex-col items-center justify-center gap-4 sm:flex-row">
            <a
              href="#book-call"
              class="cta-button group min-h-16 whitespace-nowrap px-10 py-5 text-lg font-bold"
            >
              {p.hero.ctas.primary}
              <Icon
                name="mdi:calendar-blank"
                class="text-xl shrink-0 transition-transform group-hover:translate-x-0.5"
              />
            </a>
            <a
              href={howItWorksUrl}
              class="cta-outline inline-flex min-h-16 items-center justify-center rounded-2xl px-10 py-5 text-lg font-semibold"
            >
              See How It Works
            </a>
          </div>

          <div class="mt-10 flex flex-wrap items-center justify-center gap-4">
            <span class="hero-trust-item">
              <Icon
                name="mdi:check-circle-outline"
                class="text-[var(--brand-accent)] text-base"
              />
              No Long-Term Contracts
            </span>
            <span class="hero-trust-item">
              <Icon
                name="mdi:check-circle-outline"
                class="text-[var(--brand-accent)] text-base"
              />
              Cancel Anytime
            </span>
            <span class="hero-trust-item">
              <Icon
                name="mdi:check-circle-outline"
                class="text-[var(--brand-accent)] text-base"
              />
              HVAC-Specific
            </span>
          </div>
        </div>
      </div>
    </section>

    <!-- Why you're losing money + Speed-to-Lead -->
    <section id="offers" class="section-spacing bg-neutral-50">
      <div class="container-custom">
        <div class="animate-on-scroll mb-16 text-center">
          <span class="badge mb-4 bg-primary/10 text-primary">The Problem</span>
          <h2 class="mb-6 text-4xl font-bold tracking-tight text-neutral-900 sm:text-5xl lg:text-6xl">
            {p.offers.title}
          </h2>
          <p class="mx-auto max-w-3xl text-lg leading-relaxed text-neutral-600 sm:text-xl">
            {p.offers.subtitle}
          </p>
        </div>

        <div class="animate-on-scroll">
          <div class="grid gap-6 md:grid-cols-3">
            {p.stats.items.map((item) => (
              <div class="airvvy-card group flex h-full flex-col items-center justify-center px-6 py-8 text-center md:px-7 md:py-10">
                <div class="flex flex-col gap-2">
                  <div class="text-5xl font-extrabold text-primary transition-transform group-hover:scale-105 sm:text-6xl">
                    {item.value}
                  </div>
                  <p class="text-base font-semibold leading-relaxed text-neutral-700">
                    {item.caption}
                  </p>
                </div>
              </div>
            ))}
          </div>

          <div class="mt-12 flex flex-col items-center justify-center gap-4">
            <a
              href="#book-call"
              class="cta-button group min-h-14 whitespace-nowrap px-9 py-4 text-base font-bold"
            >
              Start your Free 7-Day Pilot
              <Icon
                name="mdi:arrow-right"
                class="text-lg transition-transform group-hover:translate-x-1 shrink-0"
              />
            </a>
            <p class="text-sm font-medium text-neutral-600">
              <Icon name="mdi:shield-check" class="text-primary inline" />
              {" "}
              7-day risk-free trial • No payment required • Cancel anytime
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Why Our Agent is Better Section -->
    <section id="why-agent-better" class="section-spacing">
      <div class="container-custom">
      <div class="animate-on-scroll mb-16 text-center">
        <h2 class="mb-6 text-4xl font-bold tracking-tight text-neutral-900 sm:text-5xl lg:text-6xl">
          {p.whyAgentBetter.title}
        </h2>
        <p class="mx-auto max-w-3xl text-lg leading-relaxed text-neutral-600 sm:text-xl">
          {p.whyAgentBetter.subtitle}
        </p>
      </div>

      <div class="animate-on-scroll mx-auto max-w-4xl space-y-8">
        <div class="agent-card airvvy-card p-8 sm:p-10">
          <ul class="agent-bullets space-y-4 text-left text-base leading-relaxed text-neutral-700 sm:text-lg">
            {p.whyAgentBetter.bullets.map((bullet) => (
              <li>{bullet}</li>
            ))}
          </ul>
        </div>

        <div class="airvvy-card group relative border-2 border-primary/20 p-10 sm:p-14">
          <!-- Accent line at top -->
          <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-transparent via-[var(--brand-secondary)] to-transparent opacity-70"></div>

          <div class="text-center">
            <div class="mb-8">
              <span class="inline-block rounded-lg bg-primary/10 px-6 py-2.5 text-sm font-bold uppercase tracking-wider text-primary shadow-sm">
                <Icon name="mdi:chart-line" class="inline mr-1.5 text-base" />
                {p.whyAgentBetter.insightLabel}
              </span>
            </div>
            <p class="text-4xl font-extrabold leading-tight text-neutral-900 sm:text-5xl lg:text-6xl">
              {p.whyAgentBetter.highlight.text}
            </p>
            <div class="mt-8 flex justify-center">
              <div class="inline-flex items-center gap-2 rounded-full bg-accent px-5 py-2 text-sm font-semibold text-accent-foreground">
                <Icon name="mdi:check-circle" class="text-base" />
                {p.whyAgentBetter.insightTagline}
              </div>
            </div>
          </div>
        </div>
      </div>
      </div>
    </section>

    <!-- Retell Voice Agent Demo Section -->
    <section id="try-demo" class="section-spacing bg-neutral-50">
      <div class="container-custom">
      <div class="animate-on-scroll mb-16 text-center">
        <h2 class="mb-6 text-4xl font-bold tracking-tight text-neutral-900 sm:text-5xl lg:text-6xl">
          {p.midpageCta.title}
        </h2>
        <p class="mx-auto max-w-2xl text-lg leading-relaxed text-neutral-600 sm:text-xl">
          {p.midpageCta.text}
        </p>
      </div>

      <div class="animate-on-scroll flex flex-col items-center gap-10">
        <div class="demo-video-wrapper w-full max-w-4xl overflow-hidden rounded-2xl border border-neutral-200 bg-card shadow-xl">
          <div class="aspect-video w-full bg-muted/50">
            <video
              data-src="/demo.mp4"
              preload="none"
              controls
              playsinline
              class="demo-video w-full h-full object-contain"
              width="896"
              height="504"
              aria-label="HVAC Voice Agent demo"
            ></video>
          </div>
        </div>

        <div class="flex flex-col items-center gap-2">
          <p class="text-sm font-medium uppercase tracking-wider text-neutral-500">
            {p.midpageCta.phoneLabel}
          </p>
          <a
            href={`tel:${p.midpageCta.phoneNumber.replace(/\D/g, "")}`}
            class="demo-phone-number airvvy-card inline-flex items-center gap-3 px-6 py-4 text-xl font-semibold tracking-tight text-neutral-900 sm:text-2xl"
          >
            <Icon name="mdi:phone" class="text-primary text-2xl shrink-0" />
            <span>{p.midpageCta.phoneNumber}</span>
          </a>
        </div>
      </div>
      </div>
    </section>

    <!-- Why Qasten Section -->
    <section id="why-qasten" class="section-spacing bg-background">
      <div class="container-custom">
        <div class="animate-on-scroll mb-16 text-center">
          <h2 class="mb-6 text-4xl font-bold tracking-tight text-neutral-900 sm:text-5xl lg:text-6xl">
            {p.whyQasten.title}
          </h2>
          <p class="mx-auto max-w-2xl text-lg leading-relaxed text-neutral-600 sm:text-xl">
            {p.whyQasten.subtitle}
          </p>
        </div>

        <div class="animate-on-scroll mx-auto mb-16 max-w-5xl">
          <div class="grid gap-5 sm:grid-cols-2">
            {p.whyQasten.reasons.map((reason) => (
              <div class="airvvy-card group flex items-start gap-3.5 p-5 text-base leading-relaxed">
                <span class="why-qasten-dot mt-2 transition-transform group-hover:scale-125"></span>
                <span class="font-medium text-neutral-700">{reason}</span>
              </div>
            ))}
          </div>
        </div>

      <div class="animate-on-scroll why-qasten-logos">
        <p class="text-muted-foreground mb-8 text-center text-sm font-semibold uppercase tracking-widest">
          {p.whyQasten.builtByLabel}
        </p>
        <div class="flex flex-wrap items-center justify-center gap-10 sm:gap-16">
          {p.whyQasten.companies.map((company) => (
            <div class="why-qasten-logo" aria-label={company.name}>
              <img src={company.logo} alt={company.name} loading="lazy" />
            </div>
          ))}
        </div>
      </div>
      </div>
    </section>

    <!-- Cal.com Booking Section: CTA to book meetings -->
    <section id="book-call" class="section-spacing bg-neutral-50">
      <div class="container-custom max-w-6xl">
      <div class="animate-on-scroll mb-12 text-center">
        <h2 class="mb-6 text-4xl font-bold tracking-tight text-neutral-900 sm:text-5xl lg:text-6xl">
          {p.bookMeetingCta.title}
        </h2>
        <p class="mx-auto max-w-2xl text-lg leading-relaxed text-neutral-600 sm:text-xl">
          {p.bookMeetingCta.text}
        </p>
      </div>

      <div class="animate-on-scroll cal-embed-shell airvvy-card p-3 sm:p-4">
        <div
          class="w-full overflow-hidden rounded-lg"
          style="min-height:700px;height:700px;"
          id="my-cal-inline-ai-agents-consultation"
        ></div>
      </div>
      </div>
    </section>

    <script type="text/javascript">
      (function (C, A, L) { let p = function (a, ar) { a.q.push(ar); }; let d = C.document; C.Cal = C.Cal || function () { let cal = C.Cal; let ar = arguments; if (!cal.loaded) { cal.ns = {}; cal.q = cal.q || []; d.head.appendChild(d.createElement("script")).src = A; cal.loaded = true; } if (ar[0] === L) { const api = function () { p(api, arguments); }; const namespace = ar[1]; api.q = api.q || []; if(typeof namespace === "string"){cal.ns[namespace] = cal.ns[namespace] || api;p(cal.ns[namespace], ar);p(cal, ["initNamespace", namespace]);} else p(cal, ar); return;} p(cal, ar); }; })(window, "https://app.cal.com/embed/embed.js", "init");
      Cal("init", "ai-agents-consultation", {origin:"https://app.cal.com"});

      Cal.ns["ai-agents-consultation"]("inline", {
        elementOrSelector:"#my-cal-inline-ai-agents-consultation",
        config: {"layout":"month_view"},
        calLink: "qasten/ai-agents-consultation",
      });

      Cal.ns["ai-agents-consultation"]("ui", {"cssVarsPerTheme":{"light":{"cal-brand":"#4a7dbd"},"dark":{"cal-brand":"#6b9fff"}},"hideEventTypeDetails":false,"layout":"month_view"});
    </script>

<script>
  // Lazy-load demo video when it enters viewport (saves bandwidth, improves LCP)
  (function() {
    const video = document.querySelector('.demo-video[data-src]');
    if (!video) return;
    const io = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (!entry.isIntersecting) return;
        const v = entry.target;
        if (!v.dataset.src) return;
        v.src = v.dataset.src;
        v.preload = 'metadata';
        delete v.dataset.src;
        io.unobserve(v);
      });
    }, { rootMargin: '100px' });
    io.observe(video);
  })();
</script>

    <!-- FAQ Section -->
    <section
      id="faq"
      class="section-spacing relative left-1/2 w-screen -translate-x-1/2 bg-gradient-to-b from-neutral-50 to-neutral-100"
    >
      <div class="container-custom mx-auto w-full max-w-4xl">
        <div class="animate-on-scroll mb-12 text-center">
          <h2 class="mb-6 text-4xl font-bold tracking-tight text-neutral-900 sm:text-5xl lg:text-6xl">
            {p.faq.title}
          </h2>
        </div>
        <div class="animate-on-scroll airvvy-card p-10 sm:p-14">
          <FAQ faq={faqData} />
        </div>
      </div>
    </section>
  </main>
</Layout>

  <style>
    .animate-on-scroll {
      opacity: 0;
      transform: translateY(50px);
      transition: opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1), 
                  transform 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .animate-on-scroll.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .hero-trust-chip {
      border: 1px solid rgb(255 255 255 / 0.16);
      background: rgb(255 255 255 / 0.08);
      color: rgb(226 232 240 / 0.96);
      border-radius: 9999px;
      padding: 0.45rem 0.95rem;
      font-size: 0.85rem;
      font-weight: 500;
      backdrop-filter: blur(5px);
    }

    .hero-trust-item {
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      color: rgb(156 163 175);
      font-size: 0.85rem;
      font-weight: 500;
    }

    #my-cal-inline-ai-agents-consultation iframe {
      display: block;
      width: 100% !important;
      height: 100% !important;
      border: 0;
      background: transparent;
    }

    .why-qasten-logos {
      border-top: 2px solid color-mix(in srgb, var(--border), transparent 30%);
      padding-top: 48px;
    }

    .why-qasten-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 64px;
      padding: 14px 24px;
      transition: all 0.3s ease;
    }

    .why-qasten-logo img {
      height: 40px;
      max-width: 160px;
      width: auto;
      object-fit: contain;
      filter: grayscale(100%) opacity(0.6);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .why-qasten-logo:hover img {
      opacity: 1;
      filter: grayscale(0%) opacity(1);
      transform: scale(1.1);
    }

    .why-qasten-dot {
      height: 10px;
      width: 10px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--primary), color-mix(in srgb, var(--primary), var(--accent) 40%));
      display: inline-block;
      flex-shrink: 0;
      box-shadow: 0 3px 8px rgb(74 125 189 / 0.3);
    }

    .agent-card {
      backdrop-filter: blur(4px);
      position: relative;
      overflow: hidden;
    }

    .agent-card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary), color-mix(in srgb, var(--primary), var(--accent) 50%));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .agent-card:hover::before {
      opacity: 1;
    }

    .agent-bullets {
      list-style: none;
      padding-left: 0;
      margin: 0;
    }

    .agent-bullets li {
      position: relative;
      padding-left: 18px;
    }

    .agent-bullets li::before {
      content: "";
      position: absolute;
      left: 0;
      top: 0.65em;
      height: 6px;
      width: 6px;
      border-radius: 999px;
      background: linear-gradient(135deg, var(--primary), color-mix(in srgb, var(--primary), var(--accent) 40%));
      box-shadow: 0 1px 3px rgb(74 125 189 / 0.3);
    }

  </style>

<script>
  // Intersection Observer for scroll animations
  const observerOptions = {
    root: null,
    rootMargin: '0px',
    threshold: 0.1
  };
  
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, observerOptions);
  
  document.querySelectorAll('.animate-on-scroll').forEach(el => {
    observer.observe(el);
  });
</script>
